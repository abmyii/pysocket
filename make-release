#!/bin/sh
stable="$1"
last="$2"
new="$3"
echo "(update __init__.py, setup.py, CHANGELOG and then commit)"
echo "(merge master with working branch)"
echo "(delete all merged working branches)"
echo "git push"
echo "mkdir release"
echo "git archive --prefix=pysocket-$new/ master | gzip -9 > release/pysocket-$new.tar.gz"
echo "git diff v$stable master | gzip -9 > release/patch-$new.gz"
echo "git log --no-merges master ^v$last > release/ChangeLog-$new"
echo "git shortlog --no-merges master ^v$last > release/ShortLog"
echo "git diff --stat --summary -M v$last master > release/diffstat-$new"
echo "(make release branch on the remote called release-$new)"
echo "git pull"
echo "git checkout release-$new"
echo "git add -A"
echo "git commit -m 'Release $new'"
echo "git tag -a v$new"
echo "git push"
echo "git push --tags"
echo "git checkout master"
echo "git branch -d release-$new"
